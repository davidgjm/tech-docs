<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Helm template development</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/darshandsoni/asciidoctor-skins/css/material-teal.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Helm template development</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_externalize_container_args_property_through_helm_values">Externalize container <code>args</code> property through helm values</a>
<ul class="sectlevel2">
<li><a href="#_values_files">values files</a></li>
<li><a href="#_kubernetes_deployment_template">Kubernetes deployment template</a></li>
<li><a href="#_specify_custom_values_for_application_args_in_command_line_with_set_flag">Specify custom values for <code>application.args</code> in command line with <code>--set</code> flag</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_externalize_container_args_property_through_helm_values">Externalize container <code>args</code> property through helm values</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To externalize the container <code>args</code> attribute, define a value in <code>values.yaml</code> as a placeholder. The actual values of this placeholder variable can be specified through helm command line flags <code>--set</code>. Some special technique will be used to specify an array value through <code>--set</code> command line flag.</p>
</div>
<div class="paragraph">
<p>By default, there will be no actual values for the <code>args</code> property in the container definition. Hence, the <code>args</code> section should not appear in generated kubernetes manifest file if there are no actual values.</p>
</div>
<div class="paragraph">
<p>The <code>args</code> section should list the actual values specified through helm chart values either in values file or command line flags(<code>--set</code>,<code>--set-string</code>, etc)</p>
</div>
<div class="sect2">
<h3 id="_values_files">values files</h3>
<div class="paragraph">
<p>In the example below, <code>application.arg</code> will be the placeholder value for the container args.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">## active profile for the application
application:
  activeProfiles: "dev"
  projectedBootstrapPath: /etc/config/bootstrap/
  projectedCredentialsPath: /etc/config/credentials/
  args: []</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kubernetes_deployment_template">Kubernetes deployment template</h3>
<div class="paragraph">
<p>The snippet below defines that the <code>args</code> section will get generated only if values are provided for variable <code>application.args</code>. Then it iterates all the values as a YAML list.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">          {{- if .Values.application.args }}
          args:
            {{- range .Values.application.args }}
            - {{ .  }}
            {{- end }}
          {{- end }}
          volumeMounts:
            - name: config-credentials
              mountPath: {{ .Values.application.projectedCredentialsPath | trimSuffix "/" }}
              readOnly: true
            - name: cache-volume
              mountPath: {{ .Values.observability.appInsights.agentPath }}
            - name: config-application-insights
              mountPath: {{ .Values.observability.appInsights.configPath }}
            - name: config-bootstrap
              mountPath: {{ .Values.application.projectedBootstrapPath | trimSuffix "/" }}
              readOnly: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_specify_custom_values_for_application_args_in_command_line_with_set_flag">Specify custom values for <code>application.args</code> in command line with <code>--set</code> flag</h3>
<div class="paragraph">
<p>The way to specify an array value for a values key is follow the pattern of <code>--set "application.args={a,b,c}"</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This technique only works with helm 3.0+.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example below is a helm template debug command line that uses this technique</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">helm template tt1 ./my-template --debug --set "application.args={--debug.config.properties=spring.cloud.azure.credential.client-secret\,spring.cloud.azure.eventhubs.processor.checkpoint-store.account-key,--spring.profiles.active=dev,--debug}" &gt; helm-debug.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Output</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">          args:
            - --debug.config.properties=spring.cloud.azure.credential.client-secret,spring.cloud.azure.eventhubs.processor.checkpoint-store.account-key
            - --spring.profiles.active=dev
            - --debug
          volumeMounts:
            - name: config-credentials
              mountPath: /etc/config/credentials
              readOnly: true
            - name: cache-volume
              mountPath: /data/observability/agent
            - name: config-application-insights
              mountPath: /data/observability/config
            - name: config-bootstrap
              mountPath: /etc/config/bootstrap
              readOnly: true</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-06-22 13:10:08 UTC
</div>
</div>
</body>
</html>