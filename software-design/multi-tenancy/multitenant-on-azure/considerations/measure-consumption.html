<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Measure the consumption of each tenant</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/darshandsoni/asciidoctor-skins/css/material-teal.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Measure the consumption of each tenant</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_indicative_consumption_metrics">Indicative consumption metrics</a></li>
<li><a href="#_transaction_metrics">Transaction metrics</a></li>
<li><a href="#_per_request_metrics">Per-request metrics</a></li>
<li><a href="#_estimate_consumption">Estimate consumption</a></li>
<li><a href="#_on_charging_your_costs">On-charging your costs</a></li>
<li><a href="#_next_steps">Next steps</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>As a solution provider, it&#8217;s important to measure the consumption of each tenant in your multitenant solution. By measuring the consumption of each tenant, you can ensure that the cost of goods sold (COGS), for delivering the service to each tenant, is profitable. On this page, we provide guidance for technical decision-makers about the importance of measuring consumption, and the approaches you can consider to measure a tenant&#8217;s consumption, as well as the tradeoffs involved.</p>
</div>
<div class="paragraph">
<p>There are two primary concerns driving the need for measuring each tenant&#8217;s consumption:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You need to measure the actual cost to serve each tenant. This is important to monitor the profitability of the solution for each tenant.</p>
</li>
<li>
<p>You need to determine the amount to charge the tenant, when you&#8217;re using <a href="pricing-models.html#_consumption_based_pricing">consumption-based pricing</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, it can be difficult to measure the actual resources used by a tenant in a multitenant solution. Most services that can be used as part of a multitenant solution don&#8217;t automatically differentiate or break down usage, based on whatever you define a tenant to be. For example, consider a service that stores data for all of your tenants in a single relational database. It&#8217;s difficult to determine exactly how much space each tenant uses of that relational database, either in terms of storage or of the compute capacity that&#8217;s required to service any queries and requests.</p>
</div>
<div class="paragraph">
<p>By contrast, for a single-tenant solution, you can use Azure Cost Management within the Azure portal, to get a complete cost breakdown for all the Azure resources that are consumed by that tenant.</p>
</div>
<div class="paragraph">
<p>Therefore, when facing these challenges, it is important to consider how to measure consumption.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In some cases, it&#8217;s commercially acceptable to take a loss on delivering service to a tenant, for example, when you enter a new market or region. This is a commercial choice. Even in these situations, it&#8217;s still a good idea to measure the consumption of each tenant, so that you can plan for the future.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_indicative_consumption_metrics">Indicative consumption metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Modern applications (built for the cloud) are usually made up of many different services, each with different measures of consumption.For example, a storage account measures consumption based on the amount of data stored, the data transmitted, and the numbers of transactions.However, Azure App Service consumption is measured by the amount of compute resources allocated over time.If you have a solution that includes a storage account and App Service resources, then combining all these measurements together to calculate the actual COGS (cost of goods sold) can be a very difficult task.Often, it is easier to use a single indicative measurement to represent consumption in the solution.</p>
</div>
<div class="paragraph">
<p>For example, in the case of a multitenant solution that shares a single relational database, you might determine that the data stored is a good indicative consumption metric.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Even if you use the volume of data stored by a tenant as an indicative consumption measure, it might not be a true representation of consumption for every tenant.For example, if a particular tenant does a lot more reads or runs more reporting from the solution, but it doesn&#8217;t write a lot of data, then it could use a lot more compute than the storage requirements would indicate.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is important to occasionally measure and review the actual consumption across your tenants, to determine whether the assumptions you&#8217;re making about your indicative metrics are correct.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_transaction_metrics">Transaction metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An alternative way of measuring consumption is to identify a key transaction that is representative of the COGS for the solution.For example, in a document management solution, it could be the number of documents created.This can be useful, if there is a core function or feature within a system that is transactional, and if it can be easily measured.</p>
</div>
<div class="paragraph">
<p>This method is usually easy and cost effective to implement, as there is usually only a single point in your application that needs to record the number of transactions that occur.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_per_request_metrics">Per-request metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In solutions that are primarily API-based, it might make sense to use a consumption metric that is based around the number of API requests being made to the solution.This can often be quite simple to implement, but it does require you to use APIs as the primary interface to the system.There will be an increased operational cost of implementing a per-request metric, especially for high volume services, because of the need to record the request utilization (for audit and billing purposes).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
User-facing solutions that consist of a single-page application (SPA), or a mobile application that uses the APIs, may not be a good fit for the per-request metric.This is because there is little understanding by the end user of the relationship between the use of the application and the consumption of APIs.Your application might be chatty (it makes many API requests) or chunky (it makes too few API requests), and the user wouldn&#8217;t notice a difference.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Make sure you store request metrics in a reliable data store that&#8217;s designed for this purpose.For example, although Azure Application Insights can track requests and can even track tenant IDs (by using <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/api-custom-events-metrics#properties">properties</a>), Application Insights is not designed to store every piece of telemetry.It removes data, as part of its <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/sampling">sampling behavior</a>.For billing and metering purposes, choose a data store that will give you a high level of accuracy.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_estimate_consumption">Estimate consumption</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When measuring the consumption for a tenant, it may be easier to provide an estimate of the consumption for the tenant, rather than trying to calculate the exact amount of consumption.For example, for a multitenant solution that serves many thousands of tenants in a single deployment, it is reasonable to approximate that the cost of serving the tenant is just a percentage of the cost of the Azure resources.</p>
</div>
<div class="paragraph">
<p>You might consider estimating the COGS for a tenant, in the following cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You aren&#8217;t using <a href="pricing-models.html#_consumption_based_pricing">consumption-based pricing</a>.</p>
</li>
<li>
<p>The usage patterns and cost for every tenant is similar, regardless of size.</p>
</li>
<li>
<p>Each tenant consumes a low percentage (say, &lt;2%), of the overall resources in the deployment.</p>
</li>
<li>
<p>The per-tenant cost is low.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You might also choose to estimate consumption in combination with <a href="#_indicative_consumption_metrics">indicative consumption metrics</a>, <a href="#_transaction_metrics">transaction metrics</a>, or <a href="#_per_request_metrics">per-request metrics</a>. For example, for an application that primarily manages documents, the percentage of overall storage used by a tenant, to store its documents, gives a close enough representation of the actual COGS. This can be a useful approach, when measuring the COGS is difficult or when it would add too much complexity to the application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_on_charging_your_costs">On-charging your costs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In some solutions, you can simply charge your customers the COGS for their tenant&#8217;s resources. For example, you might use Azure resource tags to allocate billable Azure resources to tenants. You can then determine the cost to each tenant for the set of resources that&#8217;s dedicated to them, plus a margin for profit and operation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some Azure services don&#8217;t support tags. For these services, you will need to attribute the costs to a tenant, based on the resource name, resource group, or subscription.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Azure Cost Analysis can be used to analyze Azure resource costs for single tenant solutions that use tags, resource groups, or subscriptions to attribute costs.</p>
</div>
<div class="paragraph">
<p>However, this becomes prohibitively complex in most modern multitenant solutions, because of the challenge of accurately determining the exact COGS to serve a single tenant. This method should only be considered for very simple solutions, solutions that have single-tenant resource deployments, or custom tenant-specific add-on features within a larger solution.</p>
</div>
<div class="paragraph">
<p>Some Azure services provide features that allow other methods of attribution of costs in a multitenant environment. For example, Azure Kubernetes Service supports multiple node pools, where each tenant is allocated a node pool with node pool tags, which are used to attribute costs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Consider the <a href="updates.html">update deployment model you will use</a>.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-06-22 13:10:08 UTC
</div>
</div>
</body>
</html>